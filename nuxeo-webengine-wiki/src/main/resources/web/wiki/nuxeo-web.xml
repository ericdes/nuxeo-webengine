<?xml version="1.0"?>
<component name="org.nuxeo.ecm.wiki.config">
  <documentation>
    @author Bogdan Stefanescu (bs@nuxeo.com)
    Default Wiki Objects
  </documentation>

  
  <extension target="org.nuxeo.ecm.webengine.WebEngineComponent"
             point="application">
    <webapp id="nuxeo-web" fragment="nuxeo-wiki">
      <defaultPage>default.groovy</defaultPage>
      <roots>
        <root priority="1">wiki</root>
      </roots>
      <mappings>
        <mapping pattern="^(.+)/archives/(?year:[0-9]{4})/?(?month:[0-9]{2})?">
          <script>/Blog/archives.groovy</script>
        </mapping>
        <mapping pattern="^/login">
          <script>/common/login.groovy</script>
        </mapping>
      </mappings>
    </webapp>
  </extension>

  <extension target="org.nuxeo.ecm.webengine.WebEngineComponent" point="binding">
    <binding type="WikiPage" objectId="WikiPage"/>`
    <binding type="Wiki" objectId="WikiSite"/>
  </extension>

  <extension target="org.nuxeo.ecm.webengine.WebEngineComponent" point="webObject">
    <object id="WikiObject" extends="WebObject">
      <actions>
        <action id="delete" enabled="true" handler="org.nuxeo.ecm.webengine.actions.DeleteActionHandler">
          <permission expression="WRITE"/>
        </action>
        <action id="update" enabled="true" script="common/update.groovy" handler="org.nuxeo.ecm.webengine.actions.UpateActionHandler">
          <permission expression="WRITE"/>
        </action>
        <action id="edit" enabled="true">
          <permission expression="WRITE"/>
          <category>tabview</category>
        </action>
        <action id="create" enabled="true" script="common/create.groovy" handler="org.nuxeo.ecm.webengine.actions.CreateActionHandler">
          <permission expression="WRITE"/>
        </action>
        <action id="addfile" enabled="true" script="common/addfile.groovy" handler="org.nuxeo.ecm.webengine.actions.AddFileActionHandler">
          <permission expression="WRITE"/>
        </action>
        <action id="deletefile" enabled="true" script="common/addfile.groovy" handler="org.nuxeo.ecm.webengine.actions.DeleteFileActionHandler">
          <permission expression="WRITE"/>
        </action>
      </actions>
    </object>
    <object id="WikiPage" extends="WikiObject">
      <actions>
        <action id="view_content" enabled="true">
          <permission expression="READ"/>
          <category>tabview</category>
        </action>
        <action id="edit" enabled="true">
          <permission expression="WRITE"/>
          <category>tabview</category>
        </action>
        <action id="show_versions" enabled="true">
          <permission expression="READ"/>
          <category>tabview</category>
        </action>
      </actions>
    </object>
    <object id="WikiSite" extends="WikiObject">
      <actions>
        <action id="view" enabled="true" script="Wiki/redirectToFrontpage.groovy">
          <permission expression="READ"/>
        </action>
        <action id="listPages" enabled="true" script="Wiki/listpages.groovy">
          <permission expression="READ"/>
          <category>admin</category>
        </action>
        <action id="deletePage" enabled="true" script="Wiki/deletepage.groovy">
          <permission expression="WRITE"/>
        </action>
      </actions>
    </object>
  </extension>
</component>

